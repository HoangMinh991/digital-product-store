/* 
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */


function getURLVar(t) {
    var e = [],
        o = String(document.location).split("?");
    if (o[1]) {
        var a = o[1].split("&");
        for (i = 0; i < a.length; i++) {
            var n = a[i].split("=");
            n[0] && n[1] && (e[n[0]] = n[1])
        }
        return e[t] ? e[t] : ""
    }
}

function loadMore(t,e, o) {
    $.ajax({
        method: "get",
        url: "index.php?route=common/home/loadMore",
        data: {
            category: e,
            page: t
        },
        success: function(t) {
            $(o).parent().find(".list-container .row").append(t);
            if(t == '')
                $('#loadMoreSale').text('Không còn sản phẩm nào');

        }
    });
}

function loadMoreBestSeller(t,e, o) {
    $.ajax({
        method: "get",
        url: "index.php?route=common/home/loadMore",
        data: {
            category: 7,
            page: t
        },
        success: function(t) {
            $(o).parent().find(".list-container .row").append(t);
            if(t == '')
                $('#loadMoreBestSeller').text('Không còn sản phẩm nào');

        }
    });
}

function loadMoreFeature(t,e, o) {
    $.ajax({
        method: "get",
        url: "index.php?route=common/home/loadMore",
        data: {
            category: 8,
            page: t
        },
        success: function(t) {
            $(o).parent().find(".list-container .row").append(t);
            if(t == '')
                $('#loadMoreFeature').text('Không còn sản phẩm nào');

        }
    });
}

function loadMoreOption1(t,e, o) {
    $.ajax({
        method: "get",
        url: "index.php?route=common/home/loadMore",
        data: {
            category: 9,
            page: t
        },
        success: function(t) {
            $(o).parent().find(".list-container .row").append(t);
            if(t == '')
                $('#loadMoreOption1').text('Không còn sản phẩm nào');

        }
    });
}

function loadMoreOption2(t,e, o) {
    $.ajax({
        method: "get",
        url: "index.php?route=common/home/loadMore",
        data: {
            category: 10,
            page: t
        },
        success: function(t) {
            $(o).parent().find(".list-container .row").append(t);
            if(t == '')
                $('#loadMoreOption2').text('Không còn sản phẩm nào');

        }
    });
}

function loadMoreOption3(t,e, o) {
    $.ajax({
        method: "get",
        url: "index.php?route=common/home/loadMore",
        data: {
            category: 11,
            page: t
        },
        success: function(t) {
            $(o).parent().find(".list-container .row").append(t);
            if(t == '')
                $('#loadMoreOption3').text('Không còn sản phẩm nào');

        }
    });
}

function loadMoreOption4(t,e, o) {
    $.ajax({
        method: "get",
        url: "index.php?route=common/home/loadMore",
        data: {
            category: 12,
            page: t
        },
        success: function(t) {
            $(o).parent().find(".list-container .row").append(t);
            if(t == '')
                $('#loadMoreOption4').text('Không còn sản phẩm nào');

        }
    });
}

function loadMoreMaxPrice(t, e, o) {
    $.ajax({
        method: "get",
        url: "index.php?route=common/home/loadMore",
        data: {
            category: 5,
            page: t,
            filter_price: o
        },
        success: function(t) {
            $(e).parent(".list-container").find("#max-price").append(t)
        }
    })
}

function filterMaxPrice(e, o) {
    $("#max-price").empty(), price_filter_page = 0, $(e).closest(".list-container").find(".view-more").remove(), $.ajax({
        method: "get",
        url: "index.php?route=common/home/loadMore",
        data: {
            category: 5,
            page: 0,
            filter_price: o
        },
        success: function(t) {
            $(e).closest(".list-container").find("#max-price").append(t), $(e).closest(".list-container").append('<div class="view-more btn-aqua" onclick="loadMoreMaxPrice(++price_filter_page,this,' + o + ')">Tải thêm sản phẩm</div>')
        }
    })
}

function loadGameDescription(t, e) {
    $(e).closest(".container").find(".item-detail").load("index.php?route=common/home/getGameDescription&pid=" + t + " div div"), $(e).parent().find(".active").removeClass("active"), $(e).addClass("active")
}
$(document).ready(function() {
    $(".text-danger").each(function() {
        var t = $(this).parent().parent();
        t.hasClass("form-group") && t.addClass("has-error")
    }), $("#form-currency .currency-select").on("click", function(t) {
        t.preventDefault(), $("#form-currency input[name='code']").attr("value", $(this).attr("name")), $("#form-currency").submit()
    }), $("#form-language .language-select").on("click", function(t) {
        t.preventDefault(), $("#form-language input[name='code']").attr("value", $(this).attr("name")), $("#form-language").submit()
    }), $("#search input[name='search']").parent().find("#button-search-header").on("click", function() {
        var t = $("base").attr("href") + "index.php?route=product/search",
            e = $("header #search input[name='search']").val();
        e && (t += "&search=" + encodeURIComponent(e)), location = t
    }), $("#search input[name='search']").on("keydown", function(t) {
        13 == t.keyCode && $("header #search input[name='search']").parent().find("#button-search-header").trigger("click")
    }), $("#menu .dropdown-menu").each(function() {
        var t = $("#menu").offset(),
            e = $(this).parent().offset().left + $(this).outerWidth() - (t.left + $("#menu").outerWidth());
        0 < e && $(this).css("margin-left", "-" + (5 + e) + "px")
    }), $("#list-view").click(function() {
        $(".products-category > .clearfix.visible-lg-block").remove(), $("#content .product-layout").attr("class", "product-layout product-list col-xs-12"), localStorage.setItem("display", "list"), $(".btn-group").find("#list-view").addClass("selected"), $(".btn-group").find("#grid-view").removeClass("selected")
    }), $(document).on("keydown", "#collapse-checkout-option input[name='email'], #collapse-checkout-option input[name='password']", function(t) {
        13 == t.keyCode && $("#collapse-checkout-option #button-login").trigger("click")
    }), $("[data-toggle='tooltip']").tooltip({
        container: "body"
    }), $(document).ajaxStop(function() {
        $("[data-toggle='tooltip']").tooltip({
            container: "body"
        })
    })
});
var cart = {
        buyNow: function(t, e, o) {
            $.ajax({
                url: "index.php?route=checkout/cart/add",
                type: "post",
                data: "product_id=" + t + "&quantity=" + (void 0 !== e ? e : 1),
                dataType: "json",
                beforeSend: function() {
                    $("#cart > button").button("loading"), $(o).attr("disabled", !0)
                },
                complete: function() {
                    $("#cart > button").button("reset")
                },
                success: function(t) {
                    $(o).attr("disabled", !1), $(".alert, .text-danger").remove(), t.redirect && (location = t.redirect), t.success && (location = "index.php?route=checkout/checkout")
                },
                error: function(t, e, o) {
                    alert(o + "\r\n" + t.statusText + "\r\n" + t.responseText)
                }
            })
        },
        add: function(t, e, o) {
            $.ajax({
                url: "index.php?route=checkout/cart/add",
                type: "post",
                data: "product_id=" + t + "&quantity=" + (void 0 !== e ? e : 1),
                dataType: "json",
                beforeSend: function() {
                    $("#cart > button").button("loading"), $(o).attr("disabled", !0)
                },
                complete: function() {
                    $("#cart > button").button("reset")
                },
                success: function(t) {
                    toastr.success(t.success);
                    $(o).attr("disabled", !1), $(".alert, .text-danger").remove(), t.redirect && (location = t.redirect), t.success && ($(".breadcrumb").after('<div class="alert alert-success"><i class="fa fa-check-circle"></i> ' + t.success + ' <button type="button" class="close" data-dismiss="alert">&times;</button></div>'), setTimeout(function() {
                        $("#cart > button").html('<div class="pull-left flip"><h4></h4></div><span id="cart-total"> ' + t.total + '</span> <i class="fa fa-caret-down"></i>'), $("#home-cart .heading span:nth-child(3)").html(t.total.split(" ")[0])
                    }, 100), $("#cart > ul").load("index.php?route=common/cart/info ul li"), $("#home-cart > ul").load("index.php?route=common/cart/info ul li"), $("#alert-position").empty(), $("#alert-position").append('<div class="alert alert-success"><i class="fa fa-check-circle"></i> ' + t.success + ' <button type="button" class="close" data-dismiss="alert">&times;</button></div>'), $(o).find("i").addClass("icon-added"))
                },
                error: function(t, e, o) {
                    alert(o + "\r\n" + t.statusText + "\r\n" + t.responseText)
                }
            })
        },
        update: function(t, e) {
            $.ajax({
                url: "index.php?route=checkout/cart/edit",
                type: "post",
                data: "key=" + t + "&quantity=" + (void 0 !== e ? e : 1),
                dataType: "json",
                beforeSend: function() {
                    $("#cart > button").button("loading")
                },
                complete: function() {
                    $("#cart > button").button("reset")
                },
                success: function(t) {
                    setTimeout(function() {
                        $("#cart > button").html('<div class="pull-left flip"><h4></h4></div><span id="cart-total"> ' + t.total + '</span> <i class="fa fa-caret-down"></i>')
                    }, 100), "checkout/cart" == getURLVar("route") || "checkout/checkout" == getURLVar("route") ? location = "index.php?route=checkout/cart" : $("#cart > ul").load("index.php?route=common/cart/info ul li")
                },
                error: function(t, e, o) {
                    alert(o + "\r\n" + t.statusText + "\r\n" + t.responseText)
                }
            })
        },
        remove: function(t) {
            $.ajax({
                url: "index.php?route=checkout/cart/remove",
                type: "post",
                data: "key=" + t,
                dataType: "json",
                beforeSend: function() {
                    $("#cart > button").button("loading")
                },
                complete: function() {
                    $("#cart > button").button("reset")
                },
                success: function(t) {
                    setTimeout(function() {
                        $("#cart > button").html('<div class="pull-left flip"><h4></h4></div><span id="cart-total"> ' + t.total + '</span> <i class="fa fa-caret-down"></i>'), $("#home-cart .heading span:nth-child(3)").html(t.total.split(" ")[0])
                    }, 100), "checkout/cart" == getURLVar("route") || "checkout/checkout" == getURLVar("route") ? location = "index.php?route=checkout/cart" : ($("#cart > ul").load("index.php?route=common/cart/info ul li"), $("#home-cart > ul").load("index.php?route=common/cart/info ul li")), $("#alert-position").empty(), $("#alert-position").append('<div class="alert alert-success"><i class="fa fa-check-circle"></i> ' + t.success + ' <button type="button" class="close" data-dismiss="alert">&times;</button></div>')
                },
                error: function(t, e, o) {
                    alert(o + "\r\n" + t.statusText + "\r\n" + t.responseText)
                }
            })
        }
    },
    voucher = {
        add: function() {},
        remove: function(t) {
            $.ajax({
                url: "index.php?route=checkout/cart/remove",
                type: "post",
                data: "key=" + t,
                dataType: "json",
                beforeSend: function() {
                    $("#cart > button").button("loading")
                },
                complete: function() {
                    $("#cart > button").button("reset")
                },
                success: function(t) {
                    setTimeout(function() {
                        $("#cart > button").html('<div class="pull-left flip"><h4></h4></div><span id="cart-total"> ' + t.total + '</span> <i class="fa fa-caret-down"></i>')
                    }, 100), "checkout/cart" == getURLVar("route") || "checkout/checkout" == getURLVar("route") ? location = "index.php?route=checkout/cart" : $("#cart > ul").load("index.php?route=common/cart/info ul li")
                },
                error: function(t, e, o) {
                    alert(o + "\r\n" + t.statusText + "\r\n" + t.responseText)
                }
            })
        }
    },
    wishlist = {
        add: function(t, e) {
            $.ajax({
                url: "index.php?route=account/wishlist/add",
                type: "post",
                data: "product_id=" + t,
                dataType: "json",
                success: function(t) {
                    toastr.success(t.success);
                    $(".alert").remove(), t.redirect && (location = t.redirect), t.success && ($(".breadcrumb").after('<div class="alert alert-success"><i class="fa fa-check-circle"></i> ' + t.success + ' <button type="button" class="close" data-dismiss="alert">&times;</button></div>'), $(e).find("i").addClass("icon-added")), $("#wishlist-total span").html(t.total), $("#wishlist-total").attr("title", t.total), $("#alert-position").empty(), $("#alert-position").append('<div class="alert alert-success"><i class="fa fa-check-circle"></i> ' + t.success + ' <button type="button" class="close" data-dismiss="alert">&times;</button></div>');
                },
                error: function(t, e, o) {
                    alert(o + "\r\n" + t.statusText + "\r\n" + t.responseText)
                }
            })
        },
        remove: function() {}
    },
    compare = {
        add: function(t) {
            $.ajax({
                url: "index.php?route=product/compare/add",
                type: "post",
                data: "product_id=" + t,
                dataType: "json",
                success: function(t) {
                    $(".alert").remove(), t.success && ($("#content").parent().before('<div class="alert alert-success"><i class="fa fa-check-circle"></i> ' + t.success + ' <button type="button" class="close" data-dismiss="alert">&times;</button></div>'), $("#compare-total").html(t.total), $("html, body").animate({
                        scrollTop: 0
                    }, "slow"))
                },
                error: function(t, e, o) {
                    alert(o + "\r\n" + t.statusText + "\r\n" + t.responseText)
                }
            })
        },
        remove: function() {}
    };
$(document).delegate(".agree", "click", function(t) {
        t.preventDefault(), $("#modal-agree").remove();
        var e = this;
        $.ajax({
            url: $(e).attr("href"),
            type: "get",
            dataType: "html",
            success: function(t) {
                html = '<div id="modal-agree" class="modal">', html += '  <div class="modal-dialog modal-dialog-centered">', html += '    <div class="modal-content">', html += '      <div class="modal-header">', html += '        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>', html += '        <h4 class="modal-title">' + $(e).text() + "</h4>", html += "      </div>", html += '      <div class="modal-body">' + t + "</div>", html += "    </div", html += "  </div>", html += "</div>", $("body").append(html), $("#modal-agree").modal("show")
            }
        })
    }),
    function(o) {
        o.fn.autocomplete = function(t) {
            return this.each(function() {
                this.timer = null, this.items = new Array, o.extend(this, t), o(this).attr("autocomplete", "off"), o(this).on("focus", function() {
                    this.request()
                }), o(this).on("blur", function() {
                    setTimeout(function(t) {
                        t.hide()
                    }, 200, this)
                }), o(this).on("keydown", function(t) {
                    switch (t.keyCode) {
                        case 27:
                            this.hide();
                            break;
                        default:
                            this.request()
                    }
                }), this.click = function(t) {
                    t.preventDefault(), value = o(t.target).parent().attr("data-value"), value && this.items[value] && this.select(this.items[value])
                }, this.show = function() {
                    var t = o(this).position();
                    o(this).siblings("ul.dropdown-menu").css({
                        top: t.top + o(this).outerHeight(),
                        left: t.left
                    }), o(this).siblings("ul.dropdown-menu").show()
                }, this.hide = function() {
                    o(this).siblings("ul.dropdown-menu").hide()
                }, this.request = function() {
                    clearTimeout(this.timer), this.timer = setTimeout(function(t) {
                        t.source(o(t).val(), o.proxy(t.response, t))
                    }, 200, this)
                }, this.response = function(t) {
                    if (html = "", t.length) {
                        for (i = 0; i < t.length; i++) this.items[t[i].value] = t[i];
                        for (i = 0; i < t.length; i++) t[i].category || (html += '<li data-value="' + t[i].value + '"><a href="#">' + t[i].label + "</a></li>");
                        var e = new Array;
                        for (i = 0; i < t.length; i++) t[i].category && (e[t[i].category] || (e[t[i].category] = new Array, e[t[i].category].name = t[i].category, e[t[i].category].item = new Array), e[t[i].category].item.push(t[i]));
                        for (i in e)
                            for (html += '<li class="dropdown-header">' + e[i].name + "</li>", j = 0; j < e[i].item.length; j++) html += '<li data-value="' + e[i].item[j].value + '"><a href="#">&nbsp;&nbsp;&nbsp;' + e[i].item[j].label + "</a></li>"
                    }
                    html ? this.show() : this.hide(), o(this).siblings("ul.dropdown-menu").html(html)
                }, o(this).after('<ul class="dropdown-menu"></ul>'), o(this).siblings("ul.dropdown-menu").delegate("a", "click", o.proxy(this.click, this))
            })
        }
    }(window.jQuery);